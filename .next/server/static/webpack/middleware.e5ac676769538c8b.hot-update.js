"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.ts":
/*!***********************!*\
  !*** ./middleware.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(middleware)/./node_modules/next/dist/esm/server/web/exports/next-response.js\");\n\n// Definição de perfis e suas rotas permitidas\nconst roleRoutes = {\n    admin: [\n        \"/app/dashboard\",\n        \"/app/pedidos\",\n        \"/app/mesas\",\n        \"/app/cardapio\",\n        \"/app/estoque\",\n        \"/app/financeiro\",\n        \"/app/relatorios\",\n        \"/app/configuracoes\",\n        \"/app/kds\",\n        \"/app/clientes\"\n    ],\n    manager: [\n        \"/app/dashboard\",\n        \"/app/pedidos\",\n        \"/app/mesas\",\n        \"/app/cardapio\",\n        \"/app/estoque\",\n        \"/app/financeiro\",\n        \"/app/relatorios\",\n        \"/app/configuracoes\",\n        \"/app/kds\",\n        \"/app/clientes\"\n    ],\n    waiter: [\n        \"/app/pedidos\",\n        \"/app/mesas\"\n    ],\n    kitchen: [\n        \"/app/kds\"\n    ],\n    cashier: [\n        \"/app/financeiro\",\n        \"/app/pedidos\"\n    ]\n};\nfunction middleware(request) {\n    const { pathname } = request.nextUrl;\n    const publicRoutes = [\n        \"/login\",\n        \"/register\",\n        \"/\"\n    ];\n    const isPublicRoute = publicRoutes.includes(pathname);\n    // Verificar cookies de autenticação\n    const authCookie = request.cookies.get(\"auth-storage\")?.value;\n    let userRole = null;\n    let isAuthenticated = false;\n    if (authCookie) {\n        try {\n            // Tentar parsear o cookie\n            const parsedCookie = JSON.parse(authCookie);\n            // O Zustand pode salvar de diferentes formas\n            if (parsedCookie.state) {\n                // Formato padrão do Zustand persist\n                isAuthenticated = parsedCookie.state.isAuthenticated || false;\n                userRole = parsedCookie.state.user?.role || null;\n            } else if (parsedCookie.isAuthenticated !== undefined) {\n                // Formato direto\n                isAuthenticated = parsedCookie.isAuthenticated;\n                userRole = parsedCookie.user?.role || null;\n            }\n        } catch (e) {\n            // Cookie malformado, tratar como não autenticado\n            isAuthenticated = false;\n            userRole = null;\n        }\n    }\n    // Se for rota pública e estiver autenticado, redireciona para o dashboard\n    if (isPublicRoute && isAuthenticated) {\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].redirect(new URL(\"/app/dashboard\", request.url));\n    }\n    // Se não for rota pública e não estiver autenticado, redireciona para o login\n    if (!isPublicRoute && !isAuthenticated) {\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].redirect(new URL(\"/login\", request.url));\n    }\n    // Se estiver autenticado, verificar permissões\n    if (isAuthenticated && !isPublicRoute) {\n        const allowedRoutes = userRole ? roleRoutes[userRole.toLowerCase()] || [] : [];\n        // Permitir acesso ao dashboard para todos os perfis autenticados\n        if (pathname === \"/app/dashboard\" || allowedRoutes.some((route)=>pathname.startsWith(route))) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].next();\n        }\n        // Se não tiver permissão, redireciona para uma página de acesso negado ou dashboard\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].redirect(new URL(\"/app/dashboard\", request.url));\n    }\n    return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].next();\n}\nconst config = {\n    matcher: [\n        \"/((?!api|_next/static|_next/image|favicon.ico).*)\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vbWlkZGxld2FyZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBMkM7QUFHM0MsOENBQThDO0FBQzlDLE1BQU1DLGFBQXVDO0lBQzNDQyxPQUFPO1FBQUM7UUFBa0I7UUFBZ0I7UUFBYztRQUFpQjtRQUFnQjtRQUFtQjtRQUFtQjtRQUFzQjtRQUFZO0tBQWdCO0lBQ2pMQyxTQUFTO1FBQUM7UUFBa0I7UUFBZ0I7UUFBYztRQUFpQjtRQUFnQjtRQUFtQjtRQUFtQjtRQUFzQjtRQUFZO0tBQWdCO0lBQ25MQyxRQUFRO1FBQUM7UUFBZ0I7S0FBYTtJQUN0Q0MsU0FBUztRQUFDO0tBQVc7SUFDckJDLFNBQVM7UUFBQztRQUFtQjtLQUFlO0FBQzlDO0FBRU8sU0FBU0MsV0FBV0MsT0FBb0I7SUFDN0MsTUFBTSxFQUFFQyxRQUFRLEVBQUUsR0FBR0QsUUFBUUUsT0FBTztJQUVwQyxNQUFNQyxlQUFlO1FBQUM7UUFBVTtRQUFhO0tBQUk7SUFDakQsTUFBTUMsZ0JBQWdCRCxhQUFhRSxRQUFRLENBQUNKO0lBRTVDLG9DQUFvQztJQUNwQyxNQUFNSyxhQUFhTixRQUFRTyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxpQkFBaUJDO0lBQ3hELElBQUlDLFdBQTBCO0lBQzlCLElBQUlDLGtCQUFrQjtJQUV0QixJQUFJTCxZQUFZO1FBQ2QsSUFBSTtZQUNGLDBCQUEwQjtZQUMxQixNQUFNTSxlQUFlQyxLQUFLQyxLQUFLLENBQUNSO1lBRWhDLDZDQUE2QztZQUM3QyxJQUFJTSxhQUFhRyxLQUFLLEVBQUU7Z0JBQ3RCLG9DQUFvQztnQkFDcENKLGtCQUFrQkMsYUFBYUcsS0FBSyxDQUFDSixlQUFlLElBQUk7Z0JBQ3hERCxXQUFXRSxhQUFhRyxLQUFLLENBQUNDLElBQUksRUFBRUMsUUFBUTtZQUM5QyxPQUFPLElBQUlMLGFBQWFELGVBQWUsS0FBS08sV0FBVztnQkFDckQsaUJBQWlCO2dCQUNqQlAsa0JBQWtCQyxhQUFhRCxlQUFlO2dCQUM5Q0QsV0FBV0UsYUFBYUksSUFBSSxFQUFFQyxRQUFRO1lBQ3hDO1FBQ0YsRUFBRSxPQUFPRSxHQUFHO1lBQ1YsaURBQWlEO1lBQ2pEUixrQkFBa0I7WUFDbEJELFdBQVc7UUFDYjtJQUNGO0lBRUEsMEVBQTBFO0lBQzFFLElBQUlOLGlCQUFpQk8saUJBQWlCO1FBQ3BDLE9BQU9uQixrRkFBWUEsQ0FBQzRCLFFBQVEsQ0FBQyxJQUFJQyxJQUFJLGtCQUFrQnJCLFFBQVFzQixHQUFHO0lBQ3BFO0lBRUEsOEVBQThFO0lBQzlFLElBQUksQ0FBQ2xCLGlCQUFpQixDQUFDTyxpQkFBaUI7UUFDdEMsT0FBT25CLGtGQUFZQSxDQUFDNEIsUUFBUSxDQUFDLElBQUlDLElBQUksVUFBVXJCLFFBQVFzQixHQUFHO0lBQzVEO0lBRUEsK0NBQStDO0lBQy9DLElBQUlYLG1CQUFtQixDQUFDUCxlQUFlO1FBQ3JDLE1BQU1tQixnQkFBZ0JiLFdBQVdqQixVQUFVLENBQUNpQixTQUFTYyxXQUFXLEdBQUcsSUFBSSxFQUFFLEdBQUcsRUFBRTtRQUU5RSxpRUFBaUU7UUFDakUsSUFBSXZCLGFBQWEsb0JBQW9Cc0IsY0FBY0UsSUFBSSxDQUFDQyxDQUFBQSxRQUFTekIsU0FBUzBCLFVBQVUsQ0FBQ0QsU0FBUztZQUM1RixPQUFPbEMsa0ZBQVlBLENBQUNvQyxJQUFJO1FBQzFCO1FBRUEsb0ZBQW9GO1FBQ3BGLE9BQU9wQyxrRkFBWUEsQ0FBQzRCLFFBQVEsQ0FBQyxJQUFJQyxJQUFJLGtCQUFrQnJCLFFBQVFzQixHQUFHO0lBQ3BFO0lBRUEsT0FBTzlCLGtGQUFZQSxDQUFDb0MsSUFBSTtBQUMxQjtBQUVPLE1BQU1DLFNBQVM7SUFDcEJDLFNBQVM7UUFDUDtLQUNEO0FBQ0gsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9taWRkbGV3YXJlLnRzPzQyMmQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHR5cGUgeyBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJztcblxuLy8gRGVmaW5pw6fDo28gZGUgcGVyZmlzIGUgc3VhcyByb3RhcyBwZXJtaXRpZGFzXG5jb25zdCByb2xlUm91dGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7XG4gIGFkbWluOiBbJy9hcHAvZGFzaGJvYXJkJywgJy9hcHAvcGVkaWRvcycsICcvYXBwL21lc2FzJywgJy9hcHAvY2FyZGFwaW8nLCAnL2FwcC9lc3RvcXVlJywgJy9hcHAvZmluYW5jZWlybycsICcvYXBwL3JlbGF0b3Jpb3MnLCAnL2FwcC9jb25maWd1cmFjb2VzJywgJy9hcHAva2RzJywgJy9hcHAvY2xpZW50ZXMnXSxcbiAgbWFuYWdlcjogWycvYXBwL2Rhc2hib2FyZCcsICcvYXBwL3BlZGlkb3MnLCAnL2FwcC9tZXNhcycsICcvYXBwL2NhcmRhcGlvJywgJy9hcHAvZXN0b3F1ZScsICcvYXBwL2ZpbmFuY2Vpcm8nLCAnL2FwcC9yZWxhdG9yaW9zJywgJy9hcHAvY29uZmlndXJhY29lcycsICcvYXBwL2tkcycsICcvYXBwL2NsaWVudGVzJ10sXG4gIHdhaXRlcjogWycvYXBwL3BlZGlkb3MnLCAnL2FwcC9tZXNhcyddLFxuICBraXRjaGVuOiBbJy9hcHAva2RzJ10sXG4gIGNhc2hpZXI6IFsnL2FwcC9maW5hbmNlaXJvJywgJy9hcHAvcGVkaWRvcyddLFxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIG1pZGRsZXdhcmUocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3QgeyBwYXRobmFtZSB9ID0gcmVxdWVzdC5uZXh0VXJsO1xuXG4gIGNvbnN0IHB1YmxpY1JvdXRlcyA9IFsnL2xvZ2luJywgJy9yZWdpc3RlcicsICcvJ107XG4gIGNvbnN0IGlzUHVibGljUm91dGUgPSBwdWJsaWNSb3V0ZXMuaW5jbHVkZXMocGF0aG5hbWUpO1xuXG4gIC8vIFZlcmlmaWNhciBjb29raWVzIGRlIGF1dGVudGljYcOnw6NvXG4gIGNvbnN0IGF1dGhDb29raWUgPSByZXF1ZXN0LmNvb2tpZXMuZ2V0KCdhdXRoLXN0b3JhZ2UnKT8udmFsdWU7XG4gIGxldCB1c2VyUm9sZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gIGxldCBpc0F1dGhlbnRpY2F0ZWQgPSBmYWxzZTtcblxuICBpZiAoYXV0aENvb2tpZSkge1xuICAgIHRyeSB7XG4gICAgICAvLyBUZW50YXIgcGFyc2VhciBvIGNvb2tpZVxuICAgICAgY29uc3QgcGFyc2VkQ29va2llID0gSlNPTi5wYXJzZShhdXRoQ29va2llKTtcbiAgICAgIFxuICAgICAgLy8gTyBadXN0YW5kIHBvZGUgc2FsdmFyIGRlIGRpZmVyZW50ZXMgZm9ybWFzXG4gICAgICBpZiAocGFyc2VkQ29va2llLnN0YXRlKSB7XG4gICAgICAgIC8vIEZvcm1hdG8gcGFkcsOjbyBkbyBadXN0YW5kIHBlcnNpc3RcbiAgICAgICAgaXNBdXRoZW50aWNhdGVkID0gcGFyc2VkQ29va2llLnN0YXRlLmlzQXV0aGVudGljYXRlZCB8fCBmYWxzZTtcbiAgICAgICAgdXNlclJvbGUgPSBwYXJzZWRDb29raWUuc3RhdGUudXNlcj8ucm9sZSB8fCBudWxsO1xuICAgICAgfSBlbHNlIGlmIChwYXJzZWRDb29raWUuaXNBdXRoZW50aWNhdGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgLy8gRm9ybWF0byBkaXJldG9cbiAgICAgICAgaXNBdXRoZW50aWNhdGVkID0gcGFyc2VkQ29va2llLmlzQXV0aGVudGljYXRlZDtcbiAgICAgICAgdXNlclJvbGUgPSBwYXJzZWRDb29raWUudXNlcj8ucm9sZSB8fCBudWxsO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIENvb2tpZSBtYWxmb3JtYWRvLCB0cmF0YXIgY29tbyBuw6NvIGF1dGVudGljYWRvXG4gICAgICBpc0F1dGhlbnRpY2F0ZWQgPSBmYWxzZTtcbiAgICAgIHVzZXJSb2xlID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICAvLyBTZSBmb3Igcm90YSBww7pibGljYSBlIGVzdGl2ZXIgYXV0ZW50aWNhZG8sIHJlZGlyZWNpb25hIHBhcmEgbyBkYXNoYm9hcmRcbiAgaWYgKGlzUHVibGljUm91dGUgJiYgaXNBdXRoZW50aWNhdGVkKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvYXBwL2Rhc2hib2FyZCcsIHJlcXVlc3QudXJsKSk7XG4gIH1cblxuICAvLyBTZSBuw6NvIGZvciByb3RhIHDDumJsaWNhIGUgbsOjbyBlc3RpdmVyIGF1dGVudGljYWRvLCByZWRpcmVjaW9uYSBwYXJhIG8gbG9naW5cbiAgaWYgKCFpc1B1YmxpY1JvdXRlICYmICFpc0F1dGhlbnRpY2F0ZWQpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJy9sb2dpbicsIHJlcXVlc3QudXJsKSk7XG4gIH1cblxuICAvLyBTZSBlc3RpdmVyIGF1dGVudGljYWRvLCB2ZXJpZmljYXIgcGVybWlzc8O1ZXNcbiAgaWYgKGlzQXV0aGVudGljYXRlZCAmJiAhaXNQdWJsaWNSb3V0ZSkge1xuICAgIGNvbnN0IGFsbG93ZWRSb3V0ZXMgPSB1c2VyUm9sZSA/IHJvbGVSb3V0ZXNbdXNlclJvbGUudG9Mb3dlckNhc2UoKV0gfHwgW10gOiBbXTtcbiAgICBcbiAgICAvLyBQZXJtaXRpciBhY2Vzc28gYW8gZGFzaGJvYXJkIHBhcmEgdG9kb3Mgb3MgcGVyZmlzIGF1dGVudGljYWRvc1xuICAgIGlmIChwYXRobmFtZSA9PT0gJy9hcHAvZGFzaGJvYXJkJyB8fCBhbGxvd2VkUm91dGVzLnNvbWUocm91dGUgPT4gcGF0aG5hbWUuc3RhcnRzV2l0aChyb3V0ZSkpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbiAgICB9XG4gICAgXG4gICAgLy8gU2UgbsOjbyB0aXZlciBwZXJtaXNzw6NvLCByZWRpcmVjaW9uYSBwYXJhIHVtYSBww6FnaW5hIGRlIGFjZXNzbyBuZWdhZG8gb3UgZGFzaGJvYXJkXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvYXBwL2Rhc2hib2FyZCcsIHJlcXVlc3QudXJsKSk7XG4gIH1cblxuICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbn1cblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgbWF0Y2hlcjogW1xuICAgICcvKCg/IWFwaXxfbmV4dC9zdGF0aWN8X25leHQvaW1hZ2V8ZmF2aWNvbi5pY28pLiopJyxcbiAgXSxcbn07XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwicm9sZVJvdXRlcyIsImFkbWluIiwibWFuYWdlciIsIndhaXRlciIsImtpdGNoZW4iLCJjYXNoaWVyIiwibWlkZGxld2FyZSIsInJlcXVlc3QiLCJwYXRobmFtZSIsIm5leHRVcmwiLCJwdWJsaWNSb3V0ZXMiLCJpc1B1YmxpY1JvdXRlIiwiaW5jbHVkZXMiLCJhdXRoQ29va2llIiwiY29va2llcyIsImdldCIsInZhbHVlIiwidXNlclJvbGUiLCJpc0F1dGhlbnRpY2F0ZWQiLCJwYXJzZWRDb29raWUiLCJKU09OIiwicGFyc2UiLCJzdGF0ZSIsInVzZXIiLCJyb2xlIiwidW5kZWZpbmVkIiwiZSIsInJlZGlyZWN0IiwiVVJMIiwidXJsIiwiYWxsb3dlZFJvdXRlcyIsInRvTG93ZXJDYXNlIiwic29tZSIsInJvdXRlIiwic3RhcnRzV2l0aCIsIm5leHQiLCJjb25maWciLCJtYXRjaGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(middleware)/./middleware.ts\n");

/***/ })

});