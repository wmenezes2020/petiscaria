"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.ts":
/*!***********************!*\
  !*** ./middleware.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(middleware)/./node_modules/next/dist/esm/server/web/exports/next-response.js\");\n\n// Definição de perfis e suas rotas permitidas\nconst roleRoutes = {\n    admin: [\n        \"/app/dashboard\",\n        \"/app/pedidos\",\n        \"/app/mesas\",\n        \"/app/cardapio\",\n        \"/app/estoque\",\n        \"/app/financeiro\",\n        \"/app/relatorios\",\n        \"/app/configuracoes\",\n        \"/app/kds\",\n        \"/app/clientes\"\n    ],\n    manager: [\n        \"/app/dashboard\",\n        \"/app/pedidos\",\n        \"/app/mesas\",\n        \"/app/cardapio\",\n        \"/app/estoque\",\n        \"/app/financeiro\",\n        \"/app/relatorios\",\n        \"/app/configuracoes\",\n        \"/app/kds\",\n        \"/app/clientes\"\n    ],\n    waiter: [\n        \"/app/pedidos\",\n        \"/app/mesas\"\n    ],\n    kitchen: [\n        \"/app/kds\"\n    ],\n    cashier: [\n        \"/app/financeiro\",\n        \"/app/pedidos\"\n    ]\n};\nfunction middleware(request) {\n    const { pathname } = request.nextUrl;\n    // Rotas que não devem ser interceptadas pelo middleware\n    const publicRoutes = [\n        \"/login\",\n        \"/register\",\n        \"/\",\n        \"/kds\"\n    ];\n    const isPublicRoute = publicRoutes.includes(pathname);\n    // Se for rota pública, permitir acesso direto\n    if (isPublicRoute) {\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].next();\n    }\n    // Verificar cookies de autenticação\n    const authCookie = request.cookies.get(\"auth-storage\")?.value;\n    let userRole = null;\n    let isAuthenticated = false;\n    if (authCookie) {\n        try {\n            // Tentar parsear o cookie\n            const parsedCookie = JSON.parse(authCookie);\n            // O Zustand pode salvar de diferentes formas\n            if (parsedCookie.state) {\n                // Formato padrão do Zustand persist\n                isAuthenticated = parsedCookie.state.isAuthenticated || false;\n                userRole = parsedCookie.state.user?.role || null;\n            } else if (parsedCookie.isAuthenticated !== undefined) {\n                // Formato direto\n                isAuthenticated = parsedCookie.isAuthenticated;\n                userRole = parsedCookie.user?.role || null;\n            }\n        } catch (e) {\n            // Cookie malformado, tratar como não autenticado\n            isAuthenticated = false;\n            userRole = null;\n        }\n    }\n    // Se não estiver autenticado, redireciona para o login\n    if (!isAuthenticated) {\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].redirect(new URL(\"/login\", request.url));\n    }\n    // Se estiver autenticado, verificar permissões\n    const allowedRoutes = userRole ? roleRoutes[userRole.toLowerCase()] || [] : [];\n    // Permitir acesso ao dashboard para todos os perfis autenticados\n    if (pathname === \"/app/dashboard\" || allowedRoutes.some((route)=>pathname.startsWith(route))) {\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].next();\n    }\n    // Se não tiver permissão, redireciona para o dashboard\n    console.log(`Acesso negado para ${pathname} - Usuário: ${userRole} - Rotas permitidas:`, allowedRoutes);\n    return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].redirect(new URL(\"/app/dashboard\", request.url));\n    return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].next();\n}\nconst config = {\n    matcher: [\n        \"/((?!api|_next/static|_next/image|favicon.ico).*)\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vbWlkZGxld2FyZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBMkM7QUFHM0MsOENBQThDO0FBQzlDLE1BQU1DLGFBQXVDO0lBQzNDQyxPQUFPO1FBQUM7UUFBa0I7UUFBZ0I7UUFBYztRQUFpQjtRQUFnQjtRQUFtQjtRQUFtQjtRQUFzQjtRQUFZO0tBQWdCO0lBQ2pMQyxTQUFTO1FBQUM7UUFBa0I7UUFBZ0I7UUFBYztRQUFpQjtRQUFnQjtRQUFtQjtRQUFtQjtRQUFzQjtRQUFZO0tBQWdCO0lBQ25MQyxRQUFRO1FBQUM7UUFBZ0I7S0FBYTtJQUN0Q0MsU0FBUztRQUFDO0tBQVc7SUFDckJDLFNBQVM7UUFBQztRQUFtQjtLQUFlO0FBQzlDO0FBRU8sU0FBU0MsV0FBV0MsT0FBb0I7SUFDN0MsTUFBTSxFQUFFQyxRQUFRLEVBQUUsR0FBR0QsUUFBUUUsT0FBTztJQUVwQyx3REFBd0Q7SUFDeEQsTUFBTUMsZUFBZTtRQUFDO1FBQVU7UUFBYTtRQUFLO0tBQU87SUFDekQsTUFBTUMsZ0JBQWdCRCxhQUFhRSxRQUFRLENBQUNKO0lBRTVDLDhDQUE4QztJQUM5QyxJQUFJRyxlQUFlO1FBQ2pCLE9BQU9aLGtGQUFZQSxDQUFDYyxJQUFJO0lBQzFCO0lBRUEsb0NBQW9DO0lBQ3BDLE1BQU1DLGFBQWFQLFFBQVFRLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGlCQUFpQkM7SUFDeEQsSUFBSUMsV0FBMEI7SUFDOUIsSUFBSUMsa0JBQWtCO0lBRXRCLElBQUlMLFlBQVk7UUFDZCxJQUFJO1lBQ0YsMEJBQTBCO1lBQzFCLE1BQU1NLGVBQWVDLEtBQUtDLEtBQUssQ0FBQ1I7WUFFaEMsNkNBQTZDO1lBQzdDLElBQUlNLGFBQWFHLEtBQUssRUFBRTtnQkFDdEIsb0NBQW9DO2dCQUNwQ0osa0JBQWtCQyxhQUFhRyxLQUFLLENBQUNKLGVBQWUsSUFBSTtnQkFDeERELFdBQVdFLGFBQWFHLEtBQUssQ0FBQ0MsSUFBSSxFQUFFQyxRQUFRO1lBQzlDLE9BQU8sSUFBSUwsYUFBYUQsZUFBZSxLQUFLTyxXQUFXO2dCQUNyRCxpQkFBaUI7Z0JBQ2pCUCxrQkFBa0JDLGFBQWFELGVBQWU7Z0JBQzlDRCxXQUFXRSxhQUFhSSxJQUFJLEVBQUVDLFFBQVE7WUFDeEM7UUFDRixFQUFFLE9BQU9FLEdBQUc7WUFDVixpREFBaUQ7WUFDakRSLGtCQUFrQjtZQUNsQkQsV0FBVztRQUNiO0lBQ0Y7SUFFQSx1REFBdUQ7SUFDdkQsSUFBSSxDQUFDQyxpQkFBaUI7UUFDcEIsT0FBT3BCLGtGQUFZQSxDQUFDNkIsUUFBUSxDQUFDLElBQUlDLElBQUksVUFBVXRCLFFBQVF1QixHQUFHO0lBQzVEO0lBRUEsK0NBQStDO0lBQy9DLE1BQU1DLGdCQUFnQmIsV0FBV2xCLFVBQVUsQ0FBQ2tCLFNBQVNjLFdBQVcsR0FBRyxJQUFJLEVBQUUsR0FBRyxFQUFFO0lBRTlFLGlFQUFpRTtJQUNqRSxJQUFJeEIsYUFBYSxvQkFBb0J1QixjQUFjRSxJQUFJLENBQUNDLENBQUFBLFFBQVMxQixTQUFTMkIsVUFBVSxDQUFDRCxTQUFTO1FBQzVGLE9BQU9uQyxrRkFBWUEsQ0FBQ2MsSUFBSTtJQUMxQjtJQUVBLHVEQUF1RDtJQUN2RHVCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLG1CQUFtQixFQUFFN0IsU0FBUyxZQUFZLEVBQUVVLFNBQVMsb0JBQW9CLENBQUMsRUFBRWE7SUFDekYsT0FBT2hDLGtGQUFZQSxDQUFDNkIsUUFBUSxDQUFDLElBQUlDLElBQUksa0JBQWtCdEIsUUFBUXVCLEdBQUc7SUFFbEUsT0FBTy9CLGtGQUFZQSxDQUFDYyxJQUFJO0FBQzFCO0FBRU8sTUFBTXlCLFNBQVM7SUFDcEJDLFNBQVM7UUFDUDtLQUNEO0FBQ0gsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9taWRkbGV3YXJlLnRzPzQyMmQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHR5cGUgeyBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJztcblxuLy8gRGVmaW5pw6fDo28gZGUgcGVyZmlzIGUgc3VhcyByb3RhcyBwZXJtaXRpZGFzXG5jb25zdCByb2xlUm91dGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7XG4gIGFkbWluOiBbJy9hcHAvZGFzaGJvYXJkJywgJy9hcHAvcGVkaWRvcycsICcvYXBwL21lc2FzJywgJy9hcHAvY2FyZGFwaW8nLCAnL2FwcC9lc3RvcXVlJywgJy9hcHAvZmluYW5jZWlybycsICcvYXBwL3JlbGF0b3Jpb3MnLCAnL2FwcC9jb25maWd1cmFjb2VzJywgJy9hcHAva2RzJywgJy9hcHAvY2xpZW50ZXMnXSxcbiAgbWFuYWdlcjogWycvYXBwL2Rhc2hib2FyZCcsICcvYXBwL3BlZGlkb3MnLCAnL2FwcC9tZXNhcycsICcvYXBwL2NhcmRhcGlvJywgJy9hcHAvZXN0b3F1ZScsICcvYXBwL2ZpbmFuY2Vpcm8nLCAnL2FwcC9yZWxhdG9yaW9zJywgJy9hcHAvY29uZmlndXJhY29lcycsICcvYXBwL2tkcycsICcvYXBwL2NsaWVudGVzJ10sXG4gIHdhaXRlcjogWycvYXBwL3BlZGlkb3MnLCAnL2FwcC9tZXNhcyddLFxuICBraXRjaGVuOiBbJy9hcHAva2RzJ10sXG4gIGNhc2hpZXI6IFsnL2FwcC9maW5hbmNlaXJvJywgJy9hcHAvcGVkaWRvcyddLFxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIG1pZGRsZXdhcmUocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3QgeyBwYXRobmFtZSB9ID0gcmVxdWVzdC5uZXh0VXJsO1xuXG4gIC8vIFJvdGFzIHF1ZSBuw6NvIGRldmVtIHNlciBpbnRlcmNlcHRhZGFzIHBlbG8gbWlkZGxld2FyZVxuICBjb25zdCBwdWJsaWNSb3V0ZXMgPSBbJy9sb2dpbicsICcvcmVnaXN0ZXInLCAnLycsICcva2RzJ107XG4gIGNvbnN0IGlzUHVibGljUm91dGUgPSBwdWJsaWNSb3V0ZXMuaW5jbHVkZXMocGF0aG5hbWUpO1xuICBcbiAgLy8gU2UgZm9yIHJvdGEgcMO6YmxpY2EsIHBlcm1pdGlyIGFjZXNzbyBkaXJldG9cbiAgaWYgKGlzUHVibGljUm91dGUpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbiAgfVxuXG4gIC8vIFZlcmlmaWNhciBjb29raWVzIGRlIGF1dGVudGljYcOnw6NvXG4gIGNvbnN0IGF1dGhDb29raWUgPSByZXF1ZXN0LmNvb2tpZXMuZ2V0KCdhdXRoLXN0b3JhZ2UnKT8udmFsdWU7XG4gIGxldCB1c2VyUm9sZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gIGxldCBpc0F1dGhlbnRpY2F0ZWQgPSBmYWxzZTtcblxuICBpZiAoYXV0aENvb2tpZSkge1xuICAgIHRyeSB7XG4gICAgICAvLyBUZW50YXIgcGFyc2VhciBvIGNvb2tpZVxuICAgICAgY29uc3QgcGFyc2VkQ29va2llID0gSlNPTi5wYXJzZShhdXRoQ29va2llKTtcbiAgICAgIFxuICAgICAgLy8gTyBadXN0YW5kIHBvZGUgc2FsdmFyIGRlIGRpZmVyZW50ZXMgZm9ybWFzXG4gICAgICBpZiAocGFyc2VkQ29va2llLnN0YXRlKSB7XG4gICAgICAgIC8vIEZvcm1hdG8gcGFkcsOjbyBkbyBadXN0YW5kIHBlcnNpc3RcbiAgICAgICAgaXNBdXRoZW50aWNhdGVkID0gcGFyc2VkQ29va2llLnN0YXRlLmlzQXV0aGVudGljYXRlZCB8fCBmYWxzZTtcbiAgICAgICAgdXNlclJvbGUgPSBwYXJzZWRDb29raWUuc3RhdGUudXNlcj8ucm9sZSB8fCBudWxsO1xuICAgICAgfSBlbHNlIGlmIChwYXJzZWRDb29raWUuaXNBdXRoZW50aWNhdGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgLy8gRm9ybWF0byBkaXJldG9cbiAgICAgICAgaXNBdXRoZW50aWNhdGVkID0gcGFyc2VkQ29va2llLmlzQXV0aGVudGljYXRlZDtcbiAgICAgICAgdXNlclJvbGUgPSBwYXJzZWRDb29raWUudXNlcj8ucm9sZSB8fCBudWxsO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIENvb2tpZSBtYWxmb3JtYWRvLCB0cmF0YXIgY29tbyBuw6NvIGF1dGVudGljYWRvXG4gICAgICBpc0F1dGhlbnRpY2F0ZWQgPSBmYWxzZTtcbiAgICAgIHVzZXJSb2xlID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICAvLyBTZSBuw6NvIGVzdGl2ZXIgYXV0ZW50aWNhZG8sIHJlZGlyZWNpb25hIHBhcmEgbyBsb2dpblxuICBpZiAoIWlzQXV0aGVudGljYXRlZCkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL2xvZ2luJywgcmVxdWVzdC51cmwpKTtcbiAgfVxuXG4gIC8vIFNlIGVzdGl2ZXIgYXV0ZW50aWNhZG8sIHZlcmlmaWNhciBwZXJtaXNzw7Vlc1xuICBjb25zdCBhbGxvd2VkUm91dGVzID0gdXNlclJvbGUgPyByb2xlUm91dGVzW3VzZXJSb2xlLnRvTG93ZXJDYXNlKCldIHx8IFtdIDogW107XG4gIFxuICAvLyBQZXJtaXRpciBhY2Vzc28gYW8gZGFzaGJvYXJkIHBhcmEgdG9kb3Mgb3MgcGVyZmlzIGF1dGVudGljYWRvc1xuICBpZiAocGF0aG5hbWUgPT09ICcvYXBwL2Rhc2hib2FyZCcgfHwgYWxsb3dlZFJvdXRlcy5zb21lKHJvdXRlID0+IHBhdGhuYW1lLnN0YXJ0c1dpdGgocm91dGUpKSkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpO1xuICB9XG4gIFxuICAvLyBTZSBuw6NvIHRpdmVyIHBlcm1pc3PDo28sIHJlZGlyZWNpb25hIHBhcmEgbyBkYXNoYm9hcmRcbiAgY29uc29sZS5sb2coYEFjZXNzbyBuZWdhZG8gcGFyYSAke3BhdGhuYW1lfSAtIFVzdcOhcmlvOiAke3VzZXJSb2xlfSAtIFJvdGFzIHBlcm1pdGlkYXM6YCwgYWxsb3dlZFJvdXRlcyk7XG4gIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL2FwcC9kYXNoYm9hcmQnLCByZXF1ZXN0LnVybCkpO1xuXG4gIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpO1xufVxuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBtYXRjaGVyOiBbXG4gICAgJy8oKD8hYXBpfF9uZXh0L3N0YXRpY3xfbmV4dC9pbWFnZXxmYXZpY29uLmljbykuKiknLFxuICBdLFxufTtcblxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInJvbGVSb3V0ZXMiLCJhZG1pbiIsIm1hbmFnZXIiLCJ3YWl0ZXIiLCJraXRjaGVuIiwiY2FzaGllciIsIm1pZGRsZXdhcmUiLCJyZXF1ZXN0IiwicGF0aG5hbWUiLCJuZXh0VXJsIiwicHVibGljUm91dGVzIiwiaXNQdWJsaWNSb3V0ZSIsImluY2x1ZGVzIiwibmV4dCIsImF1dGhDb29raWUiLCJjb29raWVzIiwiZ2V0IiwidmFsdWUiLCJ1c2VyUm9sZSIsImlzQXV0aGVudGljYXRlZCIsInBhcnNlZENvb2tpZSIsIkpTT04iLCJwYXJzZSIsInN0YXRlIiwidXNlciIsInJvbGUiLCJ1bmRlZmluZWQiLCJlIiwicmVkaXJlY3QiLCJVUkwiLCJ1cmwiLCJhbGxvd2VkUm91dGVzIiwidG9Mb3dlckNhc2UiLCJzb21lIiwicm91dGUiLCJzdGFydHNXaXRoIiwiY29uc29sZSIsImxvZyIsImNvbmZpZyIsIm1hdGNoZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./middleware.ts\n");

/***/ })

});